var PageBuilder = function(view, res, next) {
    this.view = view;
    this.res = res;
    this.next = next;
    this.layout = res.locals.layout;
    this.locals = {};
    this.styles = "";
    this.javascript = "";
};

PageBuilder.prototype.build = function(callback) {
    var self = this;

    this.res.render(this.view, this.locals, function(err, html) {
        if (err) return self.next(err);

        var output = self.layout.render({
            content:    html,
            styles:     self.styles,
            javascript: self.javascript
        });

        callback(output);
    });
};

PageBuilder.prototype.render = function() {
    var self = this;

    this.build(function(html) {
        self.res.send(html);
    });
};

PageBuilder.prototype.setLocals = function(locals) {
    this.locals = locals;
    return this;
};

PageBuilder.prototype.setStyles = function(styles) {
    this.styles = styles;
    return this;
};

PageBuilder.prototype.setJavascript = function(javascript) {
    this.javascript = javascript;
    return this;
};

module.exports = PageBuilder;
